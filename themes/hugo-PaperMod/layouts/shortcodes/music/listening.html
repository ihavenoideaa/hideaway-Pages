<div id="songlist">loading...ï¼ˆæ•°æ®è¯»å–ä¸­...åŠ è½½å¤±è´¥è¯·åˆ·æ–°ï¼‰</div>
<!-- require APlayer -->
<script type="text/javascript" src="/APlayer.min.js"></script>

<script type="text/javascript" src="/moment.min.js"></script>
<script type="text/javascript" src="/moment.twitter.js"></script>
<!-- require MetingJS -->

<script>
document.addEventListener("DOMContentLoaded", () => {
    let limit = 3
    var memoUrl = "https://memos.xzgljiang.com/"            // memos url
    //var creatorId = 101
    //var galleryUrl = memoUrl+"api/memo?creatorId="+creatorId+"&rowStatus=NORMAL&limit="+limit+"&tag=ç›¸å†Œ"
    var galleryUrl = memoUrl+"api/memo/all?rowStatus=NORMAL&limit="+limit+"&tag=æœ€è¿‘åœ¨å¬"
    let nowNum = 1;
    fetch(galleryUrl).then(res => res.json()).then( resdata =>{
        var result = '',resultAll="",data = resdata.data
        for(var i=0;i < data.length;i++){
            var songMemos = data[i].content.replace("#æœ€è¿‘åœ¨å¬ ",'')   			// songMemos æ ‡ç­¾åçš„å…¨éƒ¨ä¿¡æ¯ 
            var songinfo = songMemos.match(/\[(.*?)\s*(.*?)\]\((.*?)\)/g)		// songinfo []() ç¬¦åˆè¿™ä¸ªæ ¼å¼çš„ä¿¡æ¯
            var comment = songMemos.split(songinfo)[1]                          // []()åçš„è¯„è®º
            //è§£æ content å†… md æ ¼å¼å›¾ç‰‡
            if(songinfo){
              songinfo.forEach(item => {
                if(nowNum < limit ){
                  nowNum ++
                  let songurl = item.replace(/\[.*?\]\((.*?)\)/g,'$1'),			// æ‹¬å·å†…çš„url
                      singer, songname, tmp = item.replace(/\[(.*?)\]\(.*?\)/g,'$1');	// [time title]
                  if (tmp.indexOf(' ') != -1) {
                      singer = tmp.split(' ')[0];
                      songname = tmp.split(' ')[1];
                  } else songname = tmp
				  
                    var tencenttype = songurl.match(/y\.qq\.com\/n\/ryqq\/songDetail/g)
					          var neteasetype = songurl.match(/music\.163\.com/g)
					          var songtype = ''	
                    var songmid = ''			
				            // é“¾æ¥æ˜¯qqéŸ³ä¹çš„
					          if(tencenttype) {
						        songtype = 'tencent'

					          // QQ éŸ³ä¹ç›´é“¾https://y.qq.com/n/ryqq/songDetail/002e4D4n44U4zE  ç½‘æ˜“äº‘https://music.163.com/#/song?id=64803 netease
					          songmid = songurl.split('/songDetail/')[1]
				            }
					          // é“¾æ¥æ˜¯ç½‘æ˜“äº‘çš„
					          if(neteasetype) {
						        songtype = 'netease'
						        songmid = songurl.split('id=')[1]
					          }

				          result += `<meting-js id="${songmid}" server="${songtype}" type="song" fixed="false" mini="false" autoplay="false" loop="none" theme="#255579" volume="0.6" prelosd="auto" mutex="true" list-folded="true"></meting-js>`
                  result += `<div style="font-size:17px;font-weight: lighter; margin:15px 0 0 0px;">`
                  result += `<a href="${songurl}" target="_blank">ğŸµ&nbsp;</a>${comment} <span style="font-size:5px" >(`  + moment(data[i].createdTs * 1000).twitter() + `)</span></div>`
                  result += `<br/>`
                }
              });
            }
        }
        var songDom = document.querySelector('#songlist');
        songDom.innerHTML = result

    });
});
</script>